{% extends "base_app.html" %}

{% load i18n %}
{% load companysettings %}
{% load staticfiles %}

{% block content %}
  <h2 class="page-header">{% trans "Questions" %}</h2>

  <div>

    <table class="large-8 columns">
      <thead>
      <tr class="row">
        <th class="large-5 columns">{% trans "Name" %}</th>
        <th class="large-5 columns">{% trans "Type" %}</th>
        <th class="large-2 columns"></th>
      </tr>
      </thead>

      <tbody>
      {% for question in question_list %}
        <tr class="row" data-id="{{ department.id }}">
          <td class="large-5 columns update-object">
            <i class="icon-pencil icon-large"></i>
            <span class="name">{{ question.name }}</span>
          </td>
          <td class="large-5 columns update-object">
            <span class="type">{{ question.type }}</span>
          </td>
          <td class="large-2 columns text-right">
            <a href="{% url 'companysettings:delete_question' question.id %}">{% trans "Delete" %}</a>
          </td>
        </tr>
      {% endfor %}
      </tbody>

    </table>

    <div class="large-4 columns">
      {% include 'companysettings/_side_form.html' with error_object_id=error_object_id %}
    </div>

  </div>

{% endblock content %}

{% block extra-js %}
  <script>
    $(document).ready(function() {
      var createUrl = "{% url 'companysettings:create_question' %}";
      var updateUrl = "{% url 'companysettings:update_question' 0 %}";
      var updateText = "{% trans 'Update' %}";
      var saveText = "{% trans 'Save' %}";
      var $form = $('.company-settings-form');
      $form.attr('action', createUrl);
      $form.find(':input[type=submit]').val(saveText);

      $('.update-object').click(function() {
        var $td = $(this);
        var $tr = $td.parent();
        var id = $tr.data('id');
        $form.attr('action', updateUrl.replace(0, id));
        $form.find('input[type=text]').val($tr.find('.name').text());
        $form.find('select').val($td.parent().find('.type').text());
        $form.find('input[type=submit]').val(updateText);
      });

      $('.clear-inputs').click(function() {
        $form.attr('action', createUrl);
        $form.find('input:enabled:visible, select').not(':input[type=submit]').each(function(index, e) {
          $(e).val('');
        });
        $form.find(':input[type=submit]').val(saveText);
      });
    });
  </script>
{% endblock extra-js %}

