{% extends "app_page.html" %}

{% load i18n %}


{% block title %}
  {% trans 'Openings' %}
{% endblock title %}


{% block page-content %}

  <h2>
    {% trans 'Openings' %}

    <span class="actions">
      <a href="{% url 'openings:create_opening' %}" class="button-positive right">
        {% trans "Create an opening" %}
      </a>
      <a href="#" class="button-positive right"
        data-reveal-id="add-applicant-modal">
        {% trans "Add a candidate" %}
      </a>
    </span>

  </h2>

  <table>
    <thead>
      <tr>
        <th>{% trans 'Title' %}</th>
        <th>{% trans 'Department' %}</th>
        <th>{% trans 'Type' %}</th>
        <th>{% trans 'Location' %}</th>
        <th>{% trans 'Applications' %}</th>
        <th>{% trans 'Published' %}</th>
        <th>{% trans 'Status' %}</th>
      </tr>
    </thead>

    <tbody>
      {% for opening in opening_list %}
        <tr>
          <td><a href="{% url 'openings:detail_opening' opening.id %}">{{ opening.title }}</a></td>
          <td>{{ opening.department|default_if_none:'—' }}</td>
          <td>{{ opening.get_employment_type_display }}</td>
          <td>{{ opening.get_location_string|default:'—' }}</td>
          <td><a href="{% url 'applications:list_applications_opening' opening.id %}">{{ opening.number_applications }}</a></td>
          <td>{{ opening.published_date|default_if_none:'—' }}</td>
          <td>{{ opening.get_status }}</td>
        </tr>
      {% endfor %}

    </tbody>
  </table>

  <div id="add-applicant-modal" class="reveal-modal">
    <h3>{% trans 'Add applicant' %}</h3>

    <div class="row">
      <div class="large-9 column">
        <select id="opening-list">
          {% for opening in opening_list %}
            <option value="{% url 'applications:manual_application' opening.pk %}">{{ opening.title }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="large-3 column">
        <button class="button-positive right" id="add-applicant">{% trans 'Add applicant' %}</button>
      </div>

    <a class="close-reveal-modal">&#215;</a>
  </div>

{% endblock page-content %}

{% block extra-js %}
  <script type="text/javascript">
   $('button#add-applicant').click(function() {
       window.location.href = $("select#opening-list option:selected").attr("value");
   });
  </script>
{% endblock extra-js %}
